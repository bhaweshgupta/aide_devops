
        <!doctype html>
        <html>
        <head>
          <meta charset="utf-8" />
          <title>Qualitron — Data Quality Report</title>
          <style>
            :root {
              --accent: #00A79D;
              --accent-hover: #008E86;
              --text: #0E141B;
              --text-subtle: #5E6A75;
              --surface: #FFFFFF;
              --surface-alt: #F6F8FA;
              --border: #E6E9EF;
              --radius: 12px;
              --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
              --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
            }
            body {
              font-family: var(--font-sans);
              margin: 24px;
              background: var(--surface);
              color: var(--text);
            }
            .brand { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
            .logo-badge {
              padding: 4px 8px;
              border-radius: var(--radius);
              border: 1px solid rgba(0,0,0,0.12);
              color: var(--accent);
              font-weight: 600;
              letter-spacing: 0.06em;
            }
            .brand-title { font-size: 16px; font-weight: 600; }
            .brand-sub { font-size: 12px; color: var(--text-subtle); }
            .rule { border: 1px solid var(--border); padding: 12px; margin: 12px 0; border-radius: var(--radius); background: var(--surface); }
            .status { text-transform: uppercase; font-size: 12px; padding: 2px 6px; border-radius: 999px; margin-left: 8px; }
            .status.passed { background: #e6ffed; color: #036400; border: 1px solid #b5e6bf; }
            .status.failed { background: #ffebe6; color: #970000; border: 1px solid #f3b1a3; }
            .status.error  { background: #fff4e5; color: #8a6d3b; border: 1px solid #ffd9a6; }
            table { border-collapse: collapse; margin-top: 8px; width: 100%; }
            th, td { border: 1px solid var(--border); padding: 6px; font-size: 12px; }
            th { background: var(--surface-alt); text-align: left; }
            pre { white-space: pre-wrap; background: var(--surface-alt); padding: 8px; border: 1px solid var(--border); border-radius: 8px; }
            .meta { display: flex; gap: 16px; color: #333; font-size: 13px; margin: 6px 0; }
            .desc { color: #444; }
            .divider { height: 1px; background: var(--border); margin: 12px 0; }
            .header { display: flex; align-items: baseline; justify-content: space-between; margin-bottom: 8px; }
            .header h1 { margin: 0; font-size: 20px; }
            .ts { color: var(--text-subtle); font-size: 12px; }
          </style>
        </head>
        <body>
          <div class="header">
            <div class="brand">
              <div class="logo-badge">[ QUALITRON ]</div>
              <div>
                <div class="brand-title">Qualitron – AI Data Quality</div>
                <div class="brand-sub">EPAM-inspired single-page UI</div>
              </div>
            </div>
            <div class="ts">Generated 2025-09-16 11:16:02 UTC</div>
          </div>
          <div class="divider"></div>

                <section class="rule">
                  <h2>
                    unique_business_ids
                    <span class="status passed">passed</span>
                  </h2>
                  <div class="meta">
                    <div><b>Severity:</b> CRITICAL</div>
                    <div><b>Violating rows:</b> 0</div>
                  </div>
                  <details>
                    <summary>SQL</summary>
                    <pre>SELECT ProductKey,
       COUNT(*) AS duplicate_count,
       &#x27;Duplicate ProductKey found&#x27; AS violation_reason
FROM `aigdqr-ragstoriches`.`adv_works_dw`.`dimproduct`
GROUP BY ProductKey
HAVING COUNT(*) &gt; 1</pre>
                  </details>
                  <details>
                    <summary>Validation details</summary>
                    <pre>{
  &quot;passed&quot;: true,
  &quot;row_count&quot;: 0,
  &quot;ge_available&quot;: true,
  &quot;details&quot;: {
    &quot;success&quot;: true,
    &quot;results&quot;: [
      {
        &quot;success&quot;: true,
        &quot;expectation_config&quot;: {
          &quot;expectation_type&quot;: &quot;expect_table_row_count_to_equal&quot;,
          &quot;kwargs&quot;: {
            &quot;value&quot;: 0,
            &quot;result_format&quot;: &quot;BASIC&quot;
          },
          &quot;meta&quot;: {}
        },
        &quot;result&quot;: {
          &quot;observed_value&quot;: 0
        },
        &quot;meta&quot;: {},
        &quot;exception_info&quot;: {
          &quot;raised_exception&quot;: false,
          &quot;exception_message&quot;: null,
          &quot;exception_traceback&quot;: null
        }
      }
    ],
    &quot;evaluation_parameters&quot;: {},
    &quot;statistics&quot;: {
      &quot;evaluated_expectations&quot;: 1,
      &quot;successful_expectations&quot;: 1,
      &quot;unsuccessful_expectations&quot;: 0,
      &quot;success_percent&quot;: 100
    },
    &quot;meta&quot;: {
      &quot;great_expectations_version&quot;: &quot;0.18.21&quot;,
      &quot;expectation_suite_name&quot;: &quot;default&quot;,
      &quot;run_id&quot;: {
        &quot;run_name&quot;: null,
        &quot;run_time&quot;: &quot;2025-09-16T16:45:02.359252+05:30&quot;
      },
      &quot;batch_kwargs&quot;: {
        &quot;ge_batch_id&quot;: &quot;63d9f1b2-92ee-11f0-96ed-4a66d731dcaa&quot;
      },
      &quot;batch_markers&quot;: {},
      &quot;batch_parameters&quot;: {},
      &quot;validation_time&quot;: &quot;20250916T111502.359153Z&quot;,
      &quot;expectation_suite_meta&quot;: {
        &quot;great_expectations_version&quot;: &quot;0.18.21&quot;
      }
    }
  }
}</pre>
                  </details>

                  <p class="desc">Ensure that business IDs (ProductKey) in the dimproduct table are unique.</p>
                </section>

                <section class="rule">
                  <h2>
                    required_attributes_present
                    <span class="status passed">passed</span>
                  </h2>
                  <div class="meta">
                    <div><b>Severity:</b> HIGH</div>
                    <div><b>Violating rows:</b> 0</div>
                  </div>
                  <details>
                    <summary>SQL</summary>
                    <pre>SELECT ProductKey,
       EnglishProductName,
       Color,
       &#x27;Required attributes are missing&#x27; AS violation_reason
FROM `aigdqr-ragstoriches`.`adv_works_dw`.`dimproduct`
WHERE EnglishProductName IS NULL
  OR Color IS NULL</pre>
                  </details>
                  <details>
                    <summary>Validation details</summary>
                    <pre>{
  &quot;passed&quot;: true,
  &quot;row_count&quot;: 0,
  &quot;ge_available&quot;: true,
  &quot;details&quot;: {
    &quot;success&quot;: true,
    &quot;results&quot;: [
      {
        &quot;success&quot;: true,
        &quot;expectation_config&quot;: {
          &quot;expectation_type&quot;: &quot;expect_table_row_count_to_equal&quot;,
          &quot;kwargs&quot;: {
            &quot;value&quot;: 0,
            &quot;result_format&quot;: &quot;BASIC&quot;
          },
          &quot;meta&quot;: {}
        },
        &quot;result&quot;: {
          &quot;observed_value&quot;: 0
        },
        &quot;meta&quot;: {},
        &quot;exception_info&quot;: {
          &quot;raised_exception&quot;: false,
          &quot;exception_message&quot;: null,
          &quot;exception_traceback&quot;: null
        }
      }
    ],
    &quot;evaluation_parameters&quot;: {},
    &quot;statistics&quot;: {
      &quot;evaluated_expectations&quot;: 1,
      &quot;successful_expectations&quot;: 1,
      &quot;unsuccessful_expectations&quot;: 0,
      &quot;success_percent&quot;: 100
    },
    &quot;meta&quot;: {
      &quot;great_expectations_version&quot;: &quot;0.18.21&quot;,
      &quot;expectation_suite_name&quot;: &quot;default&quot;,
      &quot;run_id&quot;: {
        &quot;run_name&quot;: null,
        &quot;run_time&quot;: &quot;2025-09-16T16:45:03.983209+05:30&quot;
      },
      &quot;batch_kwargs&quot;: {
        &quot;ge_batch_id&quot;: &quot;64d1c086-92ee-11f0-96ed-4a66d731dcaa&quot;
      },
      &quot;batch_markers&quot;: {},
      &quot;batch_parameters&quot;: {},
      &quot;validation_time&quot;: &quot;20250916T111503.983126Z&quot;,
      &quot;expectation_suite_meta&quot;: {
        &quot;great_expectations_version&quot;: &quot;0.18.21&quot;
      }
    }
  }
}</pre>
                  </details>

                  <p class="desc">Verify that required attributes (EnglishProductName, Color) are not null in the dimproduct table.</p>
                </section>

                <section class="rule">
                  <h2>
                    validate_size_and_color
                    <span class="status failed">failed</span>
                  </h2>
                  <div class="meta">
                    <div><b>Severity:</b> MEDIUM</div>
                    <div><b>Violating rows:</b> 50</div>
                  </div>
                  <details>
                    <summary>SQL</summary>
                    <pre>SELECT ProductKey,
       SIZE,
       Color,
       &#x27;Invalid Size or Color value&#x27; AS violation_reason
FROM `aigdqr-ragstoriches`.`adv_works_dw`.`dimproduct`
WHERE SIZE NOT IN (&#x27;Small&#x27;,
                   &#x27;Medium&#x27;,
                   &#x27;Large&#x27;)
  OR Color NOT IN (&#x27;Red&#x27;,
                   &#x27;Blue&#x27;,
                   &#x27;Green&#x27;,
                   &#x27;Black&#x27;,
                   &#x27;White&#x27;)</pre>
                  </details>
                  <details>
                    <summary>Validation details</summary>
                    <pre>{
  &quot;passed&quot;: false,
  &quot;row_count&quot;: 50,
  &quot;ge_available&quot;: true,
  &quot;details&quot;: {
    &quot;success&quot;: false,
    &quot;results&quot;: [
      {
        &quot;success&quot;: false,
        &quot;expectation_config&quot;: {
          &quot;expectation_type&quot;: &quot;expect_table_row_count_to_equal&quot;,
          &quot;kwargs&quot;: {
            &quot;value&quot;: 0,
            &quot;result_format&quot;: &quot;BASIC&quot;
          },
          &quot;meta&quot;: {}
        },
        &quot;result&quot;: {
          &quot;observed_value&quot;: 50
        },
        &quot;meta&quot;: {},
        &quot;exception_info&quot;: {
          &quot;raised_exception&quot;: false,
          &quot;exception_message&quot;: null,
          &quot;exception_traceback&quot;: null
        }
      }
    ],
    &quot;evaluation_parameters&quot;: {},
    &quot;statistics&quot;: {
      &quot;evaluated_expectations&quot;: 1,
      &quot;successful_expectations&quot;: 0,
      &quot;unsuccessful_expectations&quot;: 1,
      &quot;success_percent&quot;: 0
    },
    &quot;meta&quot;: {
      &quot;great_expectations_version&quot;: &quot;0.18.21&quot;,
      &quot;expectation_suite_name&quot;: &quot;default&quot;,
      &quot;run_id&quot;: {
        &quot;run_name&quot;: null,
        &quot;run_time&quot;: &quot;2025-09-16T16:45:05.884387+05:30&quot;
      },
      &quot;batch_kwargs&quot;: {
        &quot;ge_batch_id&quot;: &quot;65f3d594-92ee-11f0-96ed-4a66d731dcaa&quot;
      },
      &quot;batch_markers&quot;: {},
      &quot;batch_parameters&quot;: {},
      &quot;validation_time&quot;: &quot;20250916T111505.884293Z&quot;,
      &quot;expectation_suite_meta&quot;: {
        &quot;great_expectations_version&quot;: &quot;0.18.21&quot;
      }
    }
  }
}</pre>
                  </details>
                  <table><thead><tr><th>ProductKey</th><th>SIZE</th><th>Color</th><th>violation_reason</th></tr></thead><tbody><tr><td>1</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>2</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>3</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>4</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>5</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>6</td><td></td><td>Black</td><td>Invalid Size or Color value</td></tr><tr><td>7</td><td></td><td>Black</td><td>Invalid Size or Color value</td></tr><tr><td>8</td><td></td><td>Black</td><td>Invalid Size or Color value</td></tr><tr><td>9</td><td></td><td>Silver</td><td>Invalid Size or Color value</td></tr><tr><td>10</td><td></td><td>Silver</td><td>Invalid Size or Color value</td></tr><tr><td>11</td><td></td><td>Black</td><td>Invalid Size or Color value</td></tr><tr><td>12</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>13</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>14</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>15</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>16</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>17</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>18</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>19</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>20</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>21</td><td></td><td>Silver</td><td>Invalid Size or Color value</td></tr><tr><td>22</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>23</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>24</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>25</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>26</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>27</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>28</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>29</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>30</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>31</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>32</td><td></td><td>Silver</td><td>Invalid Size or Color value</td></tr><tr><td>33</td><td></td><td>Silver</td><td>Invalid Size or Color value</td></tr><tr><td>34</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>35</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>36</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>37</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>38</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>39</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>40</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>41</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>42</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>43</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>44</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>45</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>46</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>47</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>48</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>49</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr><tr><td>50</td><td></td><td>NA</td><td>Invalid Size or Color value</td></tr></tbody></table>
                  <p class="desc">Ensure that Size and Color values in dimproduct are within their respective domains.</p>
                </section>

                <section class="rule">
                  <h2>
                    active_vs_discontinued_items
                    <span class="status failed">failed</span>
                  </h2>
                  <div class="meta">
                    <div><b>Severity:</b> MEDIUM</div>
                    <div><b>Violating rows:</b> 50</div>
                  </div>
                  <details>
                    <summary>SQL</summary>
                    <pre>SELECT ProductKey,
       EndDate,
       &#x27;Item is active but has an EndDate&#x27; AS violation_reason
FROM `aigdqr-ragstoriches`.`adv_works_dw`.`dimproduct`
WHERE EndDate IS NOT NULL
  AND EndDate &lt;= current_date()</pre>
                  </details>
                  <details>
                    <summary>Validation details</summary>
                    <pre>{
  &quot;passed&quot;: false,
  &quot;row_count&quot;: 50,
  &quot;ge_available&quot;: true,
  &quot;details&quot;: {
    &quot;success&quot;: false,
    &quot;results&quot;: [
      {
        &quot;success&quot;: false,
        &quot;expectation_config&quot;: {
          &quot;expectation_type&quot;: &quot;expect_table_row_count_to_equal&quot;,
          &quot;kwargs&quot;: {
            &quot;value&quot;: 0,
            &quot;result_format&quot;: &quot;BASIC&quot;
          },
          &quot;meta&quot;: {}
        },
        &quot;result&quot;: {
          &quot;observed_value&quot;: 50
        },
        &quot;meta&quot;: {},
        &quot;exception_info&quot;: {
          &quot;raised_exception&quot;: false,
          &quot;exception_message&quot;: null,
          &quot;exception_traceback&quot;: null
        }
      }
    ],
    &quot;evaluation_parameters&quot;: {},
    &quot;statistics&quot;: {
      &quot;evaluated_expectations&quot;: 1,
      &quot;successful_expectations&quot;: 0,
      &quot;unsuccessful_expectations&quot;: 1,
      &quot;success_percent&quot;: 0
    },
    &quot;meta&quot;: {
      &quot;great_expectations_version&quot;: &quot;0.18.21&quot;,
      &quot;expectation_suite_name&quot;: &quot;default&quot;,
      &quot;run_id&quot;: {
        &quot;run_name&quot;: null,
        &quot;run_time&quot;: &quot;2025-09-16T16:45:07.535739+05:30&quot;
      },
      &quot;batch_kwargs&quot;: {
        &quot;ge_batch_id&quot;: &quot;66efc066-92ee-11f0-96ed-4a66d731dcaa&quot;
      },
      &quot;batch_markers&quot;: {},
      &quot;batch_parameters&quot;: {},
      &quot;validation_time&quot;: &quot;20250916T111507.535577Z&quot;,
      &quot;expectation_suite_meta&quot;: {
        &quot;great_expectations_version&quot;: &quot;0.18.21&quot;
      }
    }
  }
}</pre>
                  </details>
                  <table><thead><tr><th>ProductKey</th><th>EndDate</th><th>violation_reason</th></tr></thead><tbody><tr><td>212</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>213</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>215</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>216</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>218</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>219</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>220</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>221</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>223</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>224</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>226</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>227</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>229</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>230</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>232</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>233</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>235</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>236</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>238</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>239</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>241</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>242</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>244</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>245</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>247</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>248</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>250</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>251</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>253</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>254</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>256</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>257</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>259</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>260</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>262</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>263</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>264</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>265</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>266</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>267</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>268</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>269</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>270</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>271</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>272</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>273</td><td>2008-12-27T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>274</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>275</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>276</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr><tr><td>277</td><td>2007-12-28T00:00:00Z</td><td>Item is active but has an EndDate</td></tr></tbody></table>
                  <p class="desc">Distinguish active from discontinued items based on the EndDate column in dimproduct.</p>
                </section>

                <section class="rule">
                  <h2>
                    subcategory_to_category_link
                    <span class="status passed">passed</span>
                  </h2>
                  <div class="meta">
                    <div><b>Severity:</b> HIGH</div>
                    <div><b>Violating rows:</b> 0</div>
                  </div>
                  <details>
                    <summary>SQL</summary>
                    <pre>SELECT s.ProductSubcategoryKey,
       s.ProductCategoryKey,
       &#x27;Subcategory not linked to a valid category&#x27; AS violation_reason
FROM `aigdqr-ragstoriches`.`adv_works_dw`.`dimproductsubcategory` s
LEFT JOIN `aigdqr-ragstoriches`.`adv_works_dw`.`dimproductcategory` c ON s.ProductCategoryKey = c.ProductCategoryKey
WHERE c.ProductCategoryKey IS NULL</pre>
                  </details>
                  <details>
                    <summary>Validation details</summary>
                    <pre>{
  &quot;passed&quot;: true,
  &quot;row_count&quot;: 0,
  &quot;ge_available&quot;: true,
  &quot;details&quot;: {
    &quot;success&quot;: true,
    &quot;results&quot;: [
      {
        &quot;success&quot;: true,
        &quot;expectation_config&quot;: {
          &quot;expectation_type&quot;: &quot;expect_table_row_count_to_equal&quot;,
          &quot;kwargs&quot;: {
            &quot;value&quot;: 0,
            &quot;result_format&quot;: &quot;BASIC&quot;
          },
          &quot;meta&quot;: {}
        },
        &quot;result&quot;: {
          &quot;observed_value&quot;: 0
        },
        &quot;meta&quot;: {},
        &quot;exception_info&quot;: {
          &quot;raised_exception&quot;: false,
          &quot;exception_message&quot;: null,
          &quot;exception_traceback&quot;: null
        }
      }
    ],
    &quot;evaluation_parameters&quot;: {},
    &quot;statistics&quot;: {
      &quot;evaluated_expectations&quot;: 1,
      &quot;successful_expectations&quot;: 1,
      &quot;unsuccessful_expectations&quot;: 0,
      &quot;success_percent&quot;: 100
    },
    &quot;meta&quot;: {
      &quot;great_expectations_version&quot;: &quot;0.18.21&quot;,
      &quot;expectation_suite_name&quot;: &quot;default&quot;,
      &quot;run_id&quot;: {
        &quot;run_name&quot;: null,
        &quot;run_time&quot;: &quot;2025-09-16T16:45:10.174754+05:30&quot;
      },
      &quot;batch_kwargs&quot;: {
        &quot;ge_batch_id&quot;: &quot;688281ca-92ee-11f0-96ed-4a66d731dcaa&quot;
      },
      &quot;batch_markers&quot;: {},
      &quot;batch_parameters&quot;: {},
      &quot;validation_time&quot;: &quot;20250916T111510.174681Z&quot;,
      &quot;expectation_suite_meta&quot;: {
        &quot;great_expectations_version&quot;: &quot;0.18.21&quot;
      }
    }
  }
}</pre>
                  </details>

                  <p class="desc">Confirm that each subcategory in dimproductsubcategory is correctly linked to a category in dimproductcategory.</p>
                </section>

                <section class="rule">
                  <h2>
                    scd_period_consistency
                    <span class="status passed">passed</span>
                  </h2>
                  <div class="meta">
                    <div><b>Severity:</b> CRITICAL</div>
                    <div><b>Violating rows:</b> 0</div>
                  </div>
                  <details>
                    <summary>SQL</summary>
                    <pre>WITH period_check AS
  (SELECT ProductKey,
          StartDate,
          EndDate,
          ROW_NUMBER() OVER (PARTITION BY ProductKey
                             ORDER BY StartDate) AS rn
   FROM `aigdqr-ragstoriches`.`adv_works_dw`.`dimproduct`)
SELECT a.ProductKey,
       a.StartDate,
       a.EndDate,
       b.StartDate AS next_start_date,
       &#x27;Overlapping SCD periods detected&#x27; AS violation_reason
FROM period_check a
JOIN period_check b ON a.ProductKey = b.ProductKey
AND a.rn = b.rn - 1
WHERE a.EndDate &gt; b.StartDate</pre>
                  </details>
                  <details>
                    <summary>Validation details</summary>
                    <pre>{
  &quot;passed&quot;: true,
  &quot;row_count&quot;: 0,
  &quot;ge_available&quot;: true,
  &quot;details&quot;: {
    &quot;success&quot;: true,
    &quot;results&quot;: [
      {
        &quot;success&quot;: true,
        &quot;expectation_config&quot;: {
          &quot;expectation_type&quot;: &quot;expect_table_row_count_to_equal&quot;,
          &quot;kwargs&quot;: {
            &quot;value&quot;: 0,
            &quot;result_format&quot;: &quot;BASIC&quot;
          },
          &quot;meta&quot;: {}
        },
        &quot;result&quot;: {
          &quot;observed_value&quot;: 0
        },
        &quot;meta&quot;: {},
        &quot;exception_info&quot;: {
          &quot;raised_exception&quot;: false,
          &quot;exception_message&quot;: null,
          &quot;exception_traceback&quot;: null
        }
      }
    ],
    &quot;evaluation_parameters&quot;: {},
    &quot;statistics&quot;: {
      &quot;evaluated_expectations&quot;: 1,
      &quot;successful_expectations&quot;: 1,
      &quot;unsuccessful_expectations&quot;: 0,
      &quot;success_percent&quot;: 100
    },
    &quot;meta&quot;: {
      &quot;great_expectations_version&quot;: &quot;0.18.21&quot;,
      &quot;expectation_suite_name&quot;: &quot;default&quot;,
      &quot;run_id&quot;: {
        &quot;run_name&quot;: null,
        &quot;run_time&quot;: &quot;2025-09-16T16:45:11.992295+05:30&quot;
      },
      &quot;batch_kwargs&quot;: {
        &quot;ge_batch_id&quot;: &quot;6997d2ae-92ee-11f0-96ed-4a66d731dcaa&quot;
      },
      &quot;batch_markers&quot;: {},
      &quot;batch_parameters&quot;: {},
      &quot;validation_time&quot;: &quot;20250916T111511.992202Z&quot;,
      &quot;expectation_suite_meta&quot;: {
        &quot;great_expectations_version&quot;: &quot;0.18.21&quot;
      }
    }
  }
}</pre>
                  </details>

                  <p class="desc">Ensure that SCD periods in dimproduct (StartDate and EndDate) are consistent and non-overlapping.</p>
                </section>

        </body>
        </html>
